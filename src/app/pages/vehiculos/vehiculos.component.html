<div class="header custom-header pb-8 pt-5 pt-md-8">
  <div class="container-fluid">
    <div class="header-body">
      <!-- Estadísticas opcionales -->
    </div>
  </div>
</div>

<div class="container mt-4 vehiculos-container">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h3 class="mb-0">Gestión de Vehículos</h3>
    <button class="btn btn-primary" (click)="abrirFormulario()">
      <i class="fas fa-plus me-1"></i> Registrar Vehículo
    </button>
  </div>

  <div class="input-group mb-3">
    <span class="input-group-text"><i class="fas fa-search"></i></span>
    <input
      type="text"
      class="form-control"
      placeholder="Buscar por placa, marca o modelo..."
      [(ngModel)]="filtroTexto"
      (input)="filtrarVehiculos()"
    />
  </div>

  <div class="table-responsive">
    <table class="table table-bordered table-hover align-middle text-center">
      <thead class="table-light">
        <tr>
          <th>Placa</th>
          <th>Marca</th>
          <th>Modelo</th>
          <th>Capacidad</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let vehiculo of listaFiltrada; let i = index; trackBy: trackById">
          <td>{{ vehiculo.placa }}</td>
          <td>{{ vehiculo.marca }}</td>
          <td>{{ vehiculo.modelo }}</td>
          <td>{{ vehiculo.capacidad }}</td>
          <td>
            <button class="btn btn-sm btn-warning me-1" (click)="editarVehiculo(i)">
              <i class="fas fa-edit"></i>
            </button>
            <button class="btn btn-sm btn-danger" (click)="eliminarVehiculo(i)">
              <i class="fas fa-trash-alt"></i>
            </button>
          </td>
        </tr>
        <tr *ngIf="listaFiltrada.length === 0">
          <td colspan="5">No se encontraron vehículos.</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Modal formulario -->
  <div class="modal-backdrop" *ngIf="mostrarFormulario">
    <div class="modal-form">
      <h4>{{ editarIndex !== null ? 'Editar Vehículo' : 'Registrar Vehículo' }}</h4>

      <form (ngSubmit)="registrarVehiculo()" #formVehiculo="ngForm" novalidate>
        <div>
          <label for="inputPlaca">Placa</label>
          <input
            id="inputPlaca"
            type="text"
            [(ngModel)]="vehiculo.placa"
            name="vehiculoPlaca"
            required
            class="form-control"
            #placa="ngModel"
          />
          <div *ngIf="placa.invalid && placa.touched" class="text-danger small">
            La placa es requerida.
          </div>
        </div>

        <div>
          <label for="inputMarca">Marca</label>
          <input
            id="inputMarca"
            type="text"
            [(ngModel)]="vehiculo.marca"
            name="vehiculoMarca"
            required
            class="form-control"
            #marca="ngModel"
          />
          <div *ngIf="marca.invalid && marca.touched" class="text-danger small">
            La marca es requerida.
          </div>
        </div>

        <div>
          <label for="inputModelo">Modelo</label>
          <input
            id="inputModelo"
            type="text"
            [(ngModel)]="vehiculo.modelo"
            name="vehiculoModelo"
            required
            class="form-control"
            #modelo="ngModel"
          />
          <div *ngIf="modelo.invalid && modelo.touched" class="text-danger small">
            El modelo es requerido.
          </div>
        </div>

        <div>
          <label for="inputCapacidad">Capacidad</label>
          <input
            id="inputCapacidad"
            type="number"
            [(ngModel)]="vehiculo.capacidad"
            name="vehiculoCapacidad"
            required
            min="1"
            class="form-control"
            #capacidad="ngModel"
          />
          <div *ngIf="(capacidad.invalid || vehiculo.capacidad <= 0) && capacidad.touched" class="text-danger small">
            La capacidad debe ser mayor a 0.
          </div>
        </div>

        <div class="text-end">
          <button type="button" class="btn btn-secondary me-2" (click)="cerrarFormulario()">Cancelar</button>
          <button type="submit" class="btn btn-primary" [disabled]="formVehiculo.invalid">
            {{ editarIndex !== null ? 'Guardar Cambios' : 'Registrar' }}
          </button>
        </div>
      </form>
    </div>
  </div>
</div>


